/*
    ScrollMenu v 1.0.2
    Author: Sudhanshu Yadav
    Copyright (c) 2015 to Sudhanshu Yadav - ignitersworld.com , released under the MIT license.
    Demo on: http://ignitersworld.com/lab/scrollmenu/
*/

!function(o,n,e,t){"use strict";function r(n,t){var r=this;n&&o(n)[0]instanceof Element||(t=n,n=e.body),t=t||{},t=r.options=o.extend({},u,t),r.container=o(n),r.sections=r.container.find(r.options.sectionClass),r._vertical="vertical"==t.menuType,r._sectionTops=[],r._sectionHeights=[],r._scrollAnchorPos=[]}o.single=function(){var n=o({});return function(o){return n[0]=o,n}}();var l=o(e),i=o(n),s=o("body"),c=function(){return this||(1,eval)("this")}(),a=function(){},h=function(){var o=e.createElement("div");o.style.visibility="hidden",o.style.width="100px",o.style.msOverflowStyle="scrollbar",e.body.appendChild(o);var n=o.offsetWidth;o.style.overflow="scroll";var t=e.createElement("div");t.style.width="100%",o.appendChild(t);var r=t.offsetWidth;return o.parentNode.removeChild(o),n-r}();!function(){var o={};c.tmpl=function n(t,r){var l=/\W/.test(t)?new Function("obj","obj = obj || {}; var p=[],print=function(){p.push.apply(p,arguments);};p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',obj.$1 || \"\",'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');return p.join('');"):o[t]=o[t]||n(e.getElementById(t).innerHTML);return r?l(r):l}}();var u={sectionClass:"section",menuType:"vertical",appendTo:null,animateOnScroll:!0,nativeScroll:!0,scrollbarVisible:!1,onhover:a,onhoverOut:a,onscrollToSection:a,menuMod:a,anchorSetup:[],animationDuration:600,scrollAnchorSpacing:10};r.prototype={constructor:r,_init:function(){var e=this,t=e.options,r=t.nativeScroll,c=e.container;e._prepareMenu();var a=e.scrollElm;return r&&a.on("scroll",function(){e._onScroll()}),e._setScrollAchorSize(),i.on("resize.scrollMenu",function(){e.resizeTimeout&&n.clearTimeout(e.resizeTimeout),e.resizeTimeout=setTimeout(function(){r&&(c.height(""),a.add(c).height(c.is("body,html")?i.height():c.height())),e._setScrollAchorSize()},200)}),e.scrollMenuWrap.on("mousedown touchstart",function(n){n.preventDefault();var r=o.single(n.target),i="touchstart"==n.type?"touchmove":"mousemove",c="touchstart"==n.type?"touchend":"mouseup";if(r.is(".scroll-handle")){s.addClass("scroll-menu-dragging"),e._setAnchorPos();var a=e._vertical?"clientY":"clientX",h=n[a]||n.originalEvent.touches[0][a],u=e.scrollTop(),p=e._inBoundry(h);l.on(i+".scrollMenu",function(o){o.preventDefault();var n=o[a]||o.originalEvent.touches[0][a],r=e._inBoundry(n);r!==!1&&e.scrollTo(u+(n-h-(r-p)*t.scrollAnchorSpacing)/e._sizeFactor,!1)}),l.one(c,function(){l.off(i+".scrollMenu"),s.removeClass("scroll-menu-dragging")})}else{var d=e.scrollAnchors.index(r.closest(".scroll-anchor"));if(-1==d)return;setTimeout(function(){e.scrollToSection(d)},0)}}),e.scrollAnchors.hover(function(n){var r=(o.single(this),e.scrollAnchors.index(this)),l=t.anchorSetup,i=l[r]&&l[r].onhover||t.onhover;o.single(this).find(".scroll-menu-content").addClass("hovered"),i.call(this,n,e.getIndexData(r))},function(n){var r=(o.single(this),e.scrollAnchors.index(this)),l=t.anchorSetup,i=l[r]&&l[r].onhoverOut||t.onhoverOut;o.single(this).find(".scroll-menu-content").removeClass("hovered"),i.call(this,n,e.getIndexData(r))}),r&&e._onScroll(),e._setScrollAchorSize(),e},_prepareMenu:function(){var n=this,e=n.container,t=n.options,r=t.scrollbarVisible;if(e.addClass("scroller-container"),t.nativeScroll){var l=r?"width:100%":"padding-right:10px; right:-"+(10+h)+"px";e.wrapInner('<div class="content-inner-wrapper"></div>').wrapInner('<div class="content-wrapper" style="'+l+'"></div>');var s=n.scrollElm=e.find(".content-wrapper");s.add(e).height(e.is("body")?i.height():e.height()),s.css("position","absolute")}for(var c=t.anchorSetup,a=['<div class="scroll-menu-wrapper '+n.options.menuType+" "+(t.className||"")+'">'],u=0,p=n.sections.length;p>u;u++){var d=c[u]||{},v=d.template||t.template||"",f=u==p-1?"":'style="margin-'+(n._vertical?"bottom":"right")+":"+t.scrollAnchorSpacing+'px"';v=v&&'<div class="scroll-menu-content <%= className %>" style="'+("horizontal-menu"!=n.options.menuType&&"background-color : <%= backgroundColor %>")+'">'+v+"</div>";var g='<div class="scroll-anchor" '+f+">"+v+'<div class="scroll-handle-wrap" style="background-color : <%= backgroundColor %>"><div class="scroll-handle"></div></div></div>';a.push(tmpl(g,d))}a.push("</div>");var m=t.appendTo?o(t.appendTo):e;m.append(a.join(""));var _=n.scrollMenuWrap=m.find(".scroll-menu-wrapper");if(n.scrollAnchors=_.find(".scroll-anchor"),n.scrollHandles=_.find(".scroll-handle"),o.each(n.scrollAnchors,function(o){var e=c[o]&&c[o].menuMod||t.menuMod;e.call(this,n.getIndexData(o))}),r){_.css("padding-right",parseInt(_.css("padding-right"),10)+h+"px")}},scrollTop:function(){return this.scrollElm.scrollTop()},_scrollHeight:function(){var o=this;return(o.options.nativeScroll?o.scrollElm:o.container)[0].scrollHeight},_setAnchorPos:function(){var n=this,e=i.scrollTop(),t=i.scrollLeft(),r=n._vertical;n.scrollAnchors.each(function(l){var i=o(this),s=i.offset(),c=s.top-e,a=s.left-t;n._scrollAnchorPos[l]={min:r?c:a,max:r?c+i.height():a+i.width()}})},_inBoundry:function(o){for(var n,e=this._scrollAnchorPos,t=0,r=e.length;r>t;t++)if(n=e[t],o>=n.min&&o<=n.max)return t;return!1},getIndexData:function(o){var n=this;return{index:o,anchor:n.scrollAnchors[o],section:n.sections[o],anchorOptions:n.options.anchorSetup[o]}},_scrollTo:function(o,n,e){this.scrollElm.animate({scrollTop:o+"px"},n,e)},scrollTo:function(o,n,e){var r=this,l=r.options;e=e||("function"==typeof n?n:a),n=n==t||"function"==typeof n?!0:n;var i=l.animateOnScroll&&n?l.animationDuration:0;r._scrollTo(o,i,e)},scrollToSection:function(o,n,e){e=e||("function"==typeof n?n:a);var r=this,l=isNaN(o)?r.sections.index(r.sections.filter(o)):o,i=r.options,s=i.anchorSetup,c=r._sectionTops[l];c!=t&&r.scrollTo(c,n,function(){var o=r.getIndexData(l);(s[l]&&s[l].onscrollToSection||i.onscrollToSection)(o),e(o)})},_onScroll:function(){var o=this;o._updateScrollAnchors(o.scrollTop())},_setScrollAchorSize:function(){var n=this,e=n.options,t=n.container,r=n._vertical,l=n.scrollMenuWrap,s=t.is("body,html")?i.height():t.height(),c=t.width(),a=r?Math.min(s,l.innerHeight()):Math.min(c,l.innerWidth()||1e6);100>a&&(a=r?s:c),n.scrollHeight=n._scrollHeight();var h=parseInt(l.css(r?"padding-top":"padding-left"),10)||0,u=parseInt(l.css(r?"padding-bottom":"padding-right"),10)||0,p=(a-h-u-e.scrollAnchorSpacing*(n.scrollHandles.length-1))*s/n.scrollHeight;return n.scrollHandles[r?"height":"width"](p),n._sizeFactor=p/s,n.sections.each(function(e){var t=o.single(this),l=t.innerHeight(),i=t.position().top;n._sectionHeights[e]=l,n._sectionTops[e]=i,o.single(n.scrollAnchors[e])[r?"height":"width"](l*p/s)}),n},_updateScrollAnchors:function(n){var e=this;e.scrollAnchors.each(function(t){var r=o.single(e.scrollHandles[t]),l=100*(n-e._sectionTops[t])/e._sectionHeights[t];r.css(e._vertical?"top":"left",l+"%")})},refresh:function(){this._setScrollAchorSize()},destroy:function(){var o=this;o.scrollMenuWrap.remove(),o.scrollElm&&o.scrollElm.children().children().unwrap().unwrap(),o.container.removeClass("scroller-container"),i.off("resize.scrollMenu")}},c.ScrollMenu=function(o,n){return new r(o,n)._init()},c.ScrollMenu.defaults=u}(jQuery,window,document);